
# CL-js 

Below are the javascript files that form **cl-js** library. 

## Individually

[CL-core.js](/scripts/CL-core.js)
: forms the first part of the CL.js library. Core focuses on the low level plumbing of retrieving and assembling data. It provides the low level
common library functions across library projects such as [feeds.library.caltech.edu](https://feeds.library.caltech.edu). 

[CL-feeds.js](/scripts/CL-feeds.js) 
: provides the low level content retrieval functions needed to integration content from https://feeds.library.caltech.edu.  If you are reading the source to understand how to integrate content from feeds.library.caltech.edu in other languages (e.g. Go, Python, PHP, R or Julia) this is the place to look.

[CL-feeds-ui.js](/scripts/CL-feeds-ui.js)
: forms third part of CL.js. It is UI focused. It wraps DOM manipulations to provide support for configurable views of the data retrieved by CL-feeds.js.  It's main purpose is to support building other widgets as well as making the code generated by the widgets easy to understand when embedding in your own pages.


## All together

[CL.js](/scripts/CL.js) 
: is assembled from concatenating [CL-core.js](/scripts/CL-core.js), [CL-feeds.js](/script/CL-feeds.js), and [CL-feeds-ui.js](/scripts/CL-feeds-ui.js) into a single file for faster download.


## Widgets

[CL-BuilderWidget.js](/scripts/CL-BuilderWidget.js)
: is our first widget built to generate HTML and JavaScript to make it easier to embed or re-use our content in your webpage. It makes extensive use of [CL.js](/scripts/CL.js). The generated code is for making the library content embeddable in your own webpage.

## Integrating feeds.library.caltech.edu content

### Lists and objects

If you want to build your own widgets it is handy to have
a list of the available groups and persons. This is
provided as JSON documents.

+ JSON list of [groups](/groups/group_list.json)
+ JSON list of [people](/people/people_list.json)

Getting details on a specific group or people. In each individual group or people directory you will find a `group.json` and `people.json` respectively. These files hold the summary data for the group or people. The `CL.js` library has a `CL.getGroupSummary()` and `CL.getPeopleSummary()` function that will retrieve the relevant content in each of those files..

## Multiple feeds on a page

If you're including only a single feed on your website you can use CL.js' CL object. What if you want to more than one feed on a page? What if you need separate feeds like books and articles? The CL object uses attributes to configure the standard render viewer. The settings in a viewer for books might be different from the settings we want for articles. We can configure the feeds independently if we have separate instances of the CL object. Fortunately modern JavaScript provides an easy solution with `Object.assign({}, CL)` (documentation at Mozilla's MDN [Object.assign()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/assign)).

In this example we want to have two feeds embedded in the page. We want one for books and one for articles. This examples shows how to use JavaScript's `Object.assign()` to create two independent `CL` objects for embedding each feed in a separate section of the page.

```JavaScript
    <section>
       <h1>Books</h1>
       <div id="book-feed></div>
    </section>
    <section>
       <h1>Articles</h1>
        <div id="article-feed"></div>
    </section>
    <script src="https://feeds.library.caltech.edu/scripts/CL.js"></script>
    <script>
    /* Create two CL objects to keep things separate */
    let books = Object.assign({}, CL),
        articles = Object.assign({}, CL);

    /** 
     * Configure our book feed:
     *  
     *  + recentN gets configuration from a Number 
     *    attribute called "recentN",
     *  + viewer gets configuration from an object 
     *    attribute called "viewer" 
     *
     */
    books.setAttribute("recentN", 3);
    books.setAttribute("viewer", {
        "parent_element": document.querySelector('#book-feed'),
        "filters": [ books.recentN, books.normalize_view ],
        "title_link": true,
        "pub_date": true,
        "creators": true,
        "description": true
    });
    books.getPeopleJSON("Newman-D-K", "book", function(data, err){ 
        books.viewer(data, err);
    });

    /**
     * Configure our article feed like we did with books
     */
    articles.setAttribute("recentN", 12);
    articles.setAttribute("viewer", {
        "parent_element": document.querySelector("#article-feed"),
        "filters": [ articles.recentN, articles.normalize_view ],
        "show_year_headings": true,
        "pub_date": true,
        "description": true
    });
    articles.getPeopleJSON("Newman-D-K", "recent/article", 
        function(data, err) {
            articles.viewer(data, err);
        });
    </script>
```


